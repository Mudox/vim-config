" add level 1 fold markers.
%s/\n\([1-9][0-9]\? .*\)\n\(\*\+\)/}}}1\1 {{{1\2/c

" add level 2 fold markers.
%s/\n\([1-9][0-9]\?\.1 .*\)\n\(=\+\)/\1 {{{2\2/c
%s/\n\([1-9][0-9]\?\.\%([2-9]\|[1-9][0-9]\) .*\)\n\(=\+\)/}}}2\1 {{{2\2/c

" add level 3 fold markers.
%s/\n\([1-9][0-9]\?\.[1-9][0-9]\?\.1 .*\)\n\(-\+\)/\1 {{{3\2/c
%s/\n\([1-9][0-9]\?\.[1-9][0-9]\?\.\%([2-9]\|[1-9][0-9]\) .*\)\n\(-\+\)/}}}3\1 {{{3\2/c

" add level 4 fold markers.
%s/\n\([1-9][0-9]\?\.[1-9][0-9]\?\.[1-9][0-9]\?\.1 .*\)\n\(\.\+\)/\1 {{{4\2/c
%s/\n\([1-9][0-9]\?\.[1-9][0-9]\?\.[1-9][0-9]\?\.\%([2-9]\|[1-9][0-9]\) .*\)\n\(\.\+\)/}}}4\1 {{{4\2/c

" add level to `.*' items
" adjsut the fold level before applying.
%s/\n\n\zs\s*`.*'\ze\n/}}}4& {{{4/c
s/\n\n\zs\s*`.*'\ze\n/}}}4& {{{4/c
